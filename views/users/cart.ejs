<!DOCTYPE html>
<html lang="en">
<head>
	<title>Cart</title>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
<!--===============================================================================================-->	
	<link rel="icon" type="image/png" href="images/icons/favicon.png"/>
<!--===============================================================================================-->
	<link rel="stylesheet" type="text/css" href="vendor/bootstrap/css/bootstrap.min.css">
<!--===============================================================================================-->
	<link rel="stylesheet" type="text/css" href="fonts/font-awesome-4.7.0/css/font-awesome.min.css">
<!--===============================================================================================-->
	<link rel="stylesheet" type="text/css" href="fonts/iconic/css/material-design-iconic-font.min.css">
<!--===============================================================================================-->
	<link rel="stylesheet" type="text/css" href="fonts/linearicons-v1.0.0/icon-font.min.css">
<!--===============================================================================================-->
	<link rel="stylesheet" type="text/css" href="vendor/animate/animate.css">
<!--===============================================================================================-->	
	<link rel="stylesheet" type="text/css" href="vendor/css-hamburgers/hamburgers.min.css">
<!--===============================================================================================-->
	<link rel="stylesheet" type="text/css" href="vendor/animsition/css/animsition.min.css">
<!--===============================================================================================-->
	<link rel="stylesheet" type="text/css" href="vendor/select2/select2.min.css">
<!--===============================================================================================-->
	<link rel="stylesheet" type="text/css" href="vendor/perfect-scrollbar/perfect-scrollbar.css">
<!--===============================================================================================-->
	<link rel="stylesheet" type="text/css" href="css/util.css">
	<link rel="stylesheet" type="text/css" href="css/main.css">



	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.3/jquery.min.js"></script>
	<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
<!--===============================================================================================-->
</head>
<body class="animsition">
	
	<!-- Header -->
	<header class="header-v4">
		<!-- Header desktop -->
		<div class="container-menu-desktop">
			
            

			<div class="wrap-menu-desktop how-shadow1">
				<nav class="limiter-menu-desktop container">
					
					<!-- Logo -->		
					<h1>DiGiZone</h1>

					<!-- Menu desktop -->
					<div class="menu-desktop">
						<ul class="main-menu">
							<li>
								<a href="/home">Home</a>
								
                                

							<li>
								<a href="/shop">Shop</a>
							</li>



							
						</ul>
					</div>	

					<!-- Icon header -->
					<div class="wrap-icon-header flex-w flex-r-m">
						<div class="icon-header-item cl2 hov-cl1 trans-04 p-l-22 p-r-11 js-show-modal-search">
							<i class="zmdi zmdi-search"></i>
						</div>

						<div class="icon-header-item cl2 hov-cl1 trans-04 p-l-22 p-r-11 " >
						<a href="/cart">	<i  class="zmdi zmdi-shopping-cart"></i></a>
						</div>

						<a href="/wishlist" class="icon-header-item cl2 hov-cl1 trans-04 p-l-22 p-r-11 " >
							<i class="zmdi zmdi-favorite-outline"></i>
						</a>
					</div>
				</nav>
			</div>	
		</div>

		<!-- Header Mobile -->
		<div class="wrap-header-mobile">
			<!-- Logo moblie -->		
			<div class="logo-mobile">
				<a href="/home"><img src="images/icons/logo-01.png" alt="IMG-LOGO"></a>
			</div>

			<!-- Icon header -->
			<div class="wrap-icon-header flex-w flex-r-m m-r-15">
				<div class="icon-header-item cl2 hov-cl1 trans-04 p-r-11 js-show-modal-search">
					<i class="zmdi zmdi-search"></i>
				</div>

				<div class="icon-header-item cl2 hov-cl1 trans-04 p-r-11 p-l-10 icon-header-noti js-show-cart" data-notify="2">
					<i class="zmdi zmdi-shopping-cart"></i>
				</div>

				<a href="#" class="dis-block icon-header-item cl2 hov-cl1 trans-04 p-r-11 p-l-10 icon-header-noti" data-notify="0">
					<i class="zmdi zmdi-favorite-outline"></i>
				</a>
			</div>

			<!-- Button show menu -->
			<div class="btn-show-menu-mobile hamburger hamburger--squeeze">
				<span class="hamburger-box">
					<span class="hamburger-inner"></span>
				</span>
			</div>
		</div>


		
		
		<!-- Modal Search -->
		<div class="modal-search-header flex-c-m trans-04 js-hide-modal-search">
			<div class="container-search-header">
				<button class="flex-c-m btn-hide-modal-search trans-04 js-hide-modal-search">
					<img src="images/icons/icon-close2.png" alt="CLOSE">
				</button>

				<form class="wrap-search-header flex-w p-l-15">
					<button class="flex-c-m trans-04">
						<i class="zmdi zmdi-search"></i>
					</button>
					<input class="plh3" type="text" name="search" placeholder="Search...">
				</form>
			</div>
		</div>
	</header>

	<!-- Cart -->
	
		

					

					
					
				
				
			
	

	<!-- breadcrumb -->
	<div class="container">
		<div class="bread-crumb flex-w p-l-25 p-r-15 p-t-30 p-lr-0-lg">
			<a href="/home" class="stext-109 cl8 hov-cl1 trans-04">
				Home
				<i class="fa fa-angle-right m-l-9 m-r-10" aria-hidden="true"></i>
			</a>

			<span class="stext-109 cl4">
				Shoping Cart
			</span>
		</div>
	</div>
		

	<!-- Shoping Cart -->
	<form class="bg0 p-t-75 p-b-85">
		<div class="container">
			<div class="row">
				<div class="col-lg-10 col-xl-7 mx-auto mb-5">
				  <div class="table-responsive">
					<table class="table table-hover">
					  <thead>
						<tr>
						  <th scope="col">Product</th>
						  <th scope="col">Name</th>
						  <th scope="col">Price</th>
						  <th scope="col">Quantity</th>
						  <th scope="col">Remove</th>
						</tr>
					  </thead>
					  <tbody>
						
							
							
						<% product.forEach((pro) => { %>
							<%if(pro.count>0){%>
						  <tr>
							<td class="align-middle">
							  <div class="d-flex align-items-center">
								<div class="img" style="width: 40px; height: 40px;">
								  <img src="admin/img/<%= pro.productId.image[0] %>" class="img-fluid" alt="">
								</div>
							  </div>
							</td>
							<td class="align-middle"><%= pro.productId.name %></td>
							<td class="align-middle"><%= pro.productId.price %></td>
							<td class="align-middle">
							  <div class="input-group col-md-12 d-flex mb-3">
								<span class="input-group-btn mr-2">
								  <button type="button" class="quantity-left-minus btn btn-outline-secondary" onclick="changeQuantity('<%= userId %>','<%= pro.productId._id %>',-1,'<%= pro.count %>')">-</button>
								</span>
								<input type="number" id="quantity" name="count" class="form-control input-number" style="text-align: center;" value="<%= pro.count %>" min="1" max="100" readonly >
								<span class="input-group-btn ml-2">
								  <button type="button" class="quantity-right-plus btn btn-outline-secondary" onclick="changeQuantity('<%= userId %>','<%= pro.productId._id %>',1,'<%= pro.count %>')">+</button>
								</span>
							  </div>
							</td>
							<td class="align-middle">
							  <div class="d-flex justify-content-center">
								<button type="button" class="btn btn-warning" onclick="Cancel('<%=pro.productId._id%>')" >Remove</button> </a>
							  </div>
							</td>
						  </tr>
						<%}%>
						<% }) %>
				
					  </tbody>
					</table>
				  </div>
				</div>
			  
			  

				<div class="col-sm-10 col-lg-7 col-xl-5 m-lr-auto m-b-50">
					<div class="bor10 p-lr-40 p-t-30 p-b-40 m-l-63 m-r-40 m-lr-0-xl p-lr-15-sm">
						<h4 class="mtext-109 cl2 p-b-30">
							CART SUMMARY
						</h4>

						<div class="flex-w flex-t bor12 p-b-13">
							<div class="size-208">
								<span class="stext-110 cl2">
									Subtotal:
								</span>
							</div>

							<div class="size-209">
								<span class="mtext-110 cl2">
									₹<%=Total%>
								</span>
							</div>
						</div>

						<div    class="flex-w flex-t bor12 p-t-15 p-b-30">
							<div class="size-208 w-full-ssm">
								<span class="stext-110 cl2">
									Shipping:
								</span>
							</div>

							<div class="size-209 p-r-18 p-r-0-sm w-full-ssm">
								<p class="stext-111 cl6 p-t-2">
									₹0
                                    
								</p>
								
								
								
										
								</div>


								
						
								<div class="size-208 w-full-ssm">
									<span class="stext-110 cl2">
										Total:
									</span>
								</div>
	
								<div class="size-209 p-r-18 p-r-0-sm w-full-ssm">
									<p class="stext-111 cl6 p-t-2">
										₹<%=Total%>
										
									</p>
									




							</div>
						</div>

						
						

						<button class="flex-c-m stext-101 cl0 size-116 bg3 bor14 hov-btn3 p-lr-15 trans-04 pointer">
							<a href="/checkout" class="btn btn-primary py-3 px-4">Proceed to Checkout</a>
						</button>
					</div>
				</div>
			</div>
		</div>
	</form>
		
	<script>
		function changeQuantity(userId,proId,count,prcount){
			$.ajax({
				url:'/changeProductQuantity',
				data:{
					prcount:prcount,
					user:userId,
					product:proId,
					count:count
				},
				method:'post',
				success:(response)=>{
				}
			}).done((data)=>{
				if(data.success){
					window.location.reload();
				}else if(data.check){
					Swal.fire({
						icon: 'error',
						title: 'Oops...',
						text: 'Out Of Stock!'
					})
				}
				
				
			})
		}
	</script>
		<!-- remove -->
<script>
		function Cancel(id){
			console.log(id)
			Swal.fire({
				title:'Cancel are you sure!',
				text:"You wan't be able to revert this!",
				icon:"warning",
				showCancelButton:'True',
				confirmButtonColor:"#3085d6",
				CancelButtonColor:'#d33',
				confirmButtonText:'Yes'
			}).then((result)=>{
				if(result.isConfirmed){
					$.ajax({
		url:'/removeProduct',
		method:'post',
		data:{
			id:id
		},
		success:(response)=>{
			if(response.success){
				location.reload()
			}	
		}
	})
	  }
	 })   
	}
</script>

	<%- include("./layouts/footer.ejs") %>